{"version":3,"file":"Clock.svelte","sources":["Clock.svelte"],"sourcesContent":["<script>\n  import { createEventDispatcher } from 'svelte';\n  import { fade } from 'svelte/transition';\n  import { pad } from '../utils';\n  export let time;\n  $: timeSplit = time.split(':');\n  $: hour =\n    Number.parseInt(timeSplit[0]) === 0 ? 24 : Number.parseInt(timeSplit[0]);\n  $: minute = Number.parseInt(timeSplit[1]);\n  $: seconds = Number.parseInt(timeSplit[2].substr(0, 2));\n  const dispatch = createEventDispatcher();\n  $: hourIndex = hour % 12;\n  $: size = hour > 12 ? -20 : -35;\n  let selection = 'hour';\n  let hourCoords = generateCoords(30, -40);\n  let hourMinorCoords = generateCoords(30, -25);\n  let minuteCoords = generateCoords(6, -40);\n\n  function indexToHour(i) {\n    return i === 0 ? 12 : i === 12 ? 24 : i;\n  }\n  function generateCoords(inc, length) {\n    let coords = [];\n    for (let i = 0; i < 360 / inc; i++) {\n      let degree = i * inc + 90;\n      let degreeRad = (degree * Math.PI) / 180;\n      let y = Math.sin(degreeRad) * length;\n      let x = Math.cos(degreeRad) * length;\n      coords.push({ x, y });\n    }\n    return coords;\n  }\n\n  function setHour(h) {\n    hour = h;\n    setDate();\n  }\n  function setMinute(m) {\n    minute = m;\n    setDate();\n  }\n  function setSeconds(s) {\n    seconds = s;\n    setDate();\n  }\n  function setDate() {\n    let h = hour === 24 ? 0 : hour;\n    dispatch('update', `${pad(h)}:${pad(minute)}:${pad(seconds)}`);\n  }\n</script>\n\n<svg class=\"clock\" viewBox=\"-50 -50 100 100\">\n  <circle class=\"clock-face\" r=\"48\" />\n\n  {#if selection === 'hour'}\n    <line class=\"line\" y1=\"0\" y2={size} transform=\"rotate({30 * hourIndex})\" />\n    <g transition:fade|local>\n      {#each hourCoords as coord, i}\n        <g\n          on:mouseup={() => (selection = 'minute')}\n          on:mouseover={() => {\n            setHour(indexToHour(i));\n          }}\n          on:mousedown={() => {\n            setHour(indexToHour(i));\n          }}\n          class={indexToHour(i) === hour ? 'selected' : ''}\n        >\n          <circle r=\"6\" cx={coord.x} cy={coord.y} class=\"hourCircle\" />\n          <svg x={coord.x - 10} y={coord.y - 4} width=\"20\" height=\"10\">\n            <text\n              class=\"label\"\n              x=\"50%\"\n              y=\"50%\"\n              dominant-baseline=\"middle\"\n              text-anchor=\"middle\"\n            >\n              {indexToHour(i)}\n            </text>\n          </svg>\n        </g>\n      {/each}\n\n      {#each hourMinorCoords as coord, i}\n        <g\n          on:mouseup={() => (selection = 'minute')}\n          on:mouseover={() => {\n            setHour(indexToHour(i + 12));\n          }}\n          on:mousedown={() => {\n            setHour(indexToHour(i + 12));\n          }}\n          class={indexToHour(i + 12) === hour ? 'selected' : ''}\n        >\n          <circle class=\"hourCircle\" cx={coord.x} cy={coord.y} r=\"6\" />\n          <svg x={coord.x - 10} y={coord.y - 4} width=\"20\" height=\"10\">\n            <text\n              class=\"label-inner\"\n              x=\"50%\"\n              y=\"50%\"\n              dominant-baseline=\"middle\"\n              text-anchor=\"middle\"\n            >\n              {indexToHour(i + 12)}\n            </text>\n          </svg>\n        </g>\n      {/each}\n      <text\n        class=\"title\"\n        dominant-baseline=\"middle\"\n        text-anchor=\"middle\"\n        paint-order=\"stroke\"\n      >\n        Hour\n      </text>\n    </g>\n  {:else if selection === 'minute'}\n    <g transition:fade|local class=\"mins\">\n      {#each minuteCoords as coord, i}\n        {#if i % 5 === 0}\n          <g>\n            <circle class=\"hourCircle\" cx={coord.x} cy={coord.y} r=\"6\" />\n            <svg x={coord.x - 10} y={coord.y - 4} width=\"20\" height=\"10\">\n              <text\n                class=\"label show\"\n                x=\"50%\"\n                y=\"50%\"\n                dominant-baseline=\"middle\"\n                text-anchor=\"middle\"\n              >\n                {i}\n              </text>\n            </svg>\n          </g>\n        {/if}\n      {/each}\n      {#each minuteCoords as coord, i}\n        {#if i === minute}\n          <g class=\"selected\">\n            <circle class=\"hourCircle\" cx={coord.x} cy={coord.y} r=\"6\" />\n            <svg x={coord.x - 10} y={coord.y - 4} width=\"20\" height=\"10\">\n              <text\n                class={i % 5 === 0 ? 'label show' : 'label'}\n                x=\"50%\"\n                y=\"50%\"\n                dominant-baseline=\"middle\"\n                text-anchor=\"middle\"\n              >\n                {i}\n              </text>\n            </svg>\n          </g>\n        {/if}\n      {/each}\n\n      <line class=\"line\" y1=\"0\" y2=\"-35\" transform=\"rotate({6 * minute})\" />\n      <text\n        class=\"title\"\n        dominant-baseline=\"middle\"\n        text-anchor=\"middle\"\n        paint-order=\"stroke\"\n      >\n        Minutes\n      </text>\n      {#each minuteCoords as _, i}\n        <path\n          on:mouseup={() => (selection = 'seconds')}\n          on:mouseover={() => {\n            setMinute(i);\n          }}\n          on:mousedown={() => {\n            setMinute(i);\n          }}\n          class=\"hit\"\n          d=\"M 0 0 L -2 -47 L 2 -47 Z\"\n          transform=\"rotate({6 * i})\"\n        />\n      {/each}\n    </g>\n  {:else}\n    <g transition:fade|local class=\"mins\">\n      {#each minuteCoords as coord, i}\n        {#if i % 5 === 0}\n          <g>\n            <circle class=\"hourCircle\" cx={coord.x} cy={coord.y} r=\"6\" />\n            <svg x={coord.x - 10} y={coord.y - 4} width=\"20\" height=\"10\">\n              <text\n                class=\"label show\"\n                x=\"50%\"\n                y=\"50%\"\n                dominant-baseline=\"middle\"\n                text-anchor=\"middle\"\n              >\n                {i}\n              </text>\n            </svg>\n          </g>\n        {/if}\n      {/each}\n      {#each minuteCoords as coord, i}\n        {#if i === seconds}\n          <g class=\"selected\">\n            <circle class=\"hourCircle\" cx={coord.x} cy={coord.y} r=\"6\" />\n            <svg x={coord.x - 10} y={coord.y - 4} width=\"20\" height=\"10\">\n              <text\n                class={i % 5 === 0 ? 'label show' : 'label'}\n                x=\"50%\"\n                y=\"50%\"\n                dominant-baseline=\"middle\"\n                text-anchor=\"middle\"\n              >\n                {i}\n              </text>\n            </svg>\n          </g>\n        {/if}\n      {/each}\n      <line class=\"line\" y1=\"0\" y2=\"-35\" transform=\"rotate({6 * seconds})\" />\n      <text\n        class=\"title\"\n        dominant-baseline=\"middle\"\n        text-anchor=\"middle\"\n        paint-order=\"stroke\"\n      >\n        Seconds\n      </text>\n      {#each minuteCoords as coord, i}\n        <path\n          on:click={() => dispatch('hide')}\n          on:mouseover={() => {\n            setSeconds(i);\n          }}\n          class=\"hit\"\n          d=\"M 0 0 L -2 -47 L 2 -47 Z\"\n          transform=\"rotate({6 * i})\"\n        />\n      {/each}\n    </g>\n  {/if}\n</svg>\n\n<style>\n  .clock {\n    width: 100%;\n    height: 100%;\n    max-width: 20em;\n  }\n\n  circle {\n    stroke-width: 0.1;\n  }\n\n  svg text {\n    transform-origin: 50% 50%;\n  }\n\n  .label {\n    font-size: 0.5em;\n  }\n  .label-inner {\n    font-size: 0.25em;\n  }\n\n  .clock-face {\n    stroke: #555;\n    fill: white;\n  }\n\n  .hourCircle,\n  .hit {\n    stroke: transparent;\n    fill: transparent;\n    cursor: pointer;\n  }\n  g.mins text {\n    fill: transparent;\n  }\n  g.mins text.show {\n    fill: black;\n  }\n  g.selected .hourCircle {\n    fill: #00acc1;\n  }\n\n  g.selected text,\n  g.selected text.show {\n    fill: white;\n  }\n  g .hourCircle,\n  g text {\n    cursor: pointer;\n  }\n  .line {\n    stroke: #00acc1;\n    stroke-width: 2;\n  }\n  g.mins text.title,\n  text.title {\n    fill: black;\n    stroke: white;\n  }\n</style>\n"],"names":[],"mappings":"AAmPE,MAAM,4BAAC,CAAC,AACN,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,SAAS,CAAE,IAAI,AACjB,CAAC,AAED,MAAM,4BAAC,CAAC,AACN,YAAY,CAAE,GAAG,AACnB,CAAC,AAED,iBAAG,CAAC,IAAI,cAAC,CAAC,AACR,gBAAgB,CAAE,GAAG,CAAC,GAAG,AAC3B,CAAC,AAED,MAAM,4BAAC,CAAC,AACN,SAAS,CAAE,KAAK,AAClB,CAAC,AACD,YAAY,4BAAC,CAAC,AACZ,SAAS,CAAE,MAAM,AACnB,CAAC,AAED,WAAW,4BAAC,CAAC,AACX,MAAM,CAAE,IAAI,CACZ,IAAI,CAAE,KAAK,AACb,CAAC,AAED,uCAAW,CACX,IAAI,4BAAC,CAAC,AACJ,MAAM,CAAE,WAAW,CACnB,IAAI,CAAE,WAAW,CACjB,MAAM,CAAE,OAAO,AACjB,CAAC,AACD,CAAC,mBAAK,CAAC,IAAI,cAAC,CAAC,AACX,IAAI,CAAE,WAAW,AACnB,CAAC,AACD,CAAC,mBAAK,CAAC,IAAI,KAAK,cAAC,CAAC,AAChB,IAAI,CAAE,KAAK,AACb,CAAC,AACD,CAAC,uBAAS,CAAC,WAAW,cAAC,CAAC,AACtB,IAAI,CAAE,OAAO,AACf,CAAC,AAED,CAAC,uBAAS,CAAC,kBAAI,CACf,CAAC,uBAAS,CAAC,IAAI,KAAK,cAAC,CAAC,AACpB,IAAI,CAAE,KAAK,AACb,CAAC,AACD,eAAC,CAAC,yBAAW,CACb,eAAC,CAAC,IAAI,cAAC,CAAC,AACN,MAAM,CAAE,OAAO,AACjB,CAAC,AACD,KAAK,4BAAC,CAAC,AACL,MAAM,CAAE,OAAO,CACf,YAAY,CAAE,CAAC,AACjB,CAAC,AACD,CAAC,mBAAK,CAAC,IAAI,oBAAM,CACjB,IAAI,MAAM,4BAAC,CAAC,AACV,IAAI,CAAE,KAAK,CACX,MAAM,CAAE,KAAK,AACf,CAAC"}